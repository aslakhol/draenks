// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["referentialIntegrity"]
}

datasource db {
  provider             = "mysql"
  url                  = env("DATABASE_URL")
  shadowDatabaseUrl    = env("SHADOW_URL")
  referentialIntegrity = "prisma"
}

model Drinks {
  drinkId      Int                  @id @default(autoincrement())
  drinkName    String
  description  String?
  instructions String?
  variant      String?
  ingredients  IngredientForDrink[]
  bars         DrinkForBar[]
  deleted      Boolean              @default(false)
}

model Ingredients {
  ingredientId   Int                  @id @default(autoincrement())
  ingredientName String
  description    String?
  drinks         IngredientForDrink[]
  bars           IngredientForBar[]
  deleted        Boolean              @default(false)
}

model IngredientForDrink {
  ingredientForDrinkId Int           @id @default(autoincrement())
  drink                Drinks        @relation(fields: [drinkId], references: [drinkId], onDelete: Cascade)
  drinkId              Int
  ingredient           Ingredients   @relation(fields: [ingredientId], references: [ingredientId], onDelete: Cascade)
  ingredientId         Int
  amount               Float
  unit                 MeasuringUnit
}

enum MeasuringUnit {
  ML
  OZ
  PC
  DROP
  DASH
  WASH
  BARSPOON
}

model Bars {
  barId       Int                @id @default(autoincrement())
  barName     String
  ingredients IngredientForBar[]
  drinks      DrinkForBar[]
  deleted     Boolean            @default(false)
}

model IngredientForBar {
  bar          Bars        @relation(fields: [barId], references: [barId])
  barId        Int
  ingredient   Ingredients @relation(fields: [ingredientId], references: [ingredientId])
  ingredientId Int

  @@id([barId, ingredientId])
}

model DrinkForBar {
  bar     Bars   @relation(fields: [barId], references: [barId])
  barId   Int
  drink   Drinks @relation(fields: [drinkId], references: [drinkId])
  drinkId Int

  @@id([barId, drinkId])
}
